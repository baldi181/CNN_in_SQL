WITH RECURSIVE Arec(n, p, i, j, summe) AS
  (SELECT 1,
          A.p AS p,
          A.i AS i,
          A.j AS j,
          A.v AS v
   FROM A
   UNION ALL SELECT n+1,
                    Arec.p,
                    Arec.i,
                    Arec.j,
                    summe+A.v
   FROM Arec
   JOIN A ON Arec.p=A.p
   AND Arec.i=A.i
   AND Arec.j=A.j
   WHERE n<zin )
SELECT Arec.p AS p,
       Arec.i AS i,
       Arec.j AS j, 
       T(Arec.summe+b.v) AS v
FROM Arec
JOIN B ON Arec.n=B.q
WHERE n=zin